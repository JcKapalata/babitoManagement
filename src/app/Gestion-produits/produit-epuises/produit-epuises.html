<div class="container">
  <div class="header">
    <h2>Stock Épuisés</h2>
  </div>

  <div class="main">
    @if (dataSource) {
      <div class="table-wrapper">
        
        <table class="rupture-table header-only">
          <thead>
            <tr>
              <th class="col-id">Id du Produit</th>
              <th class="col-produit">Produit</th>
              <th class="col-taille">Taille</th>
              <th class="col-couleur">Couleur</th>
              <th class="col-action">Action</th>
            </tr>
          </thead>
        </table>

        <cdk-virtual-scroll-viewport itemSize="60" class="viewport">
          <table class="rupture-table">
            <tbody>
              <tr *cdkVirtualFor="let item of dataSource; trackBy: trackByFn" class="table-row">
                <td class="col-id">
                  <span>{{ item ? item.produitId : '...' }}</span>
                </td>

                <td class="col-produit">
                  @if (item) {
                    <div class="product-info">
                      <img [src]="item.image" class="thumb" loading="lazy">
                      <strong>{{ item.nomProduit }}</strong>
                    </div>
                  } @else {
                    <div class="skeleton-text">Chargement...</div>
                  }
                </td>

                <td class="col-taille">
                  @if (item) {
                    <span class="badge-taille">{{ item.taille }}</span>
                  } @else {
                    <span>...</span>
                  }
                </td>

                <td class="col-couleur">
                  {{ item ? item.couleur : '...' }}
                </td>

                <td class="col-action">
                  @if (item) {
                    <button class="btn-manage" (click)="goToDetailProduit(item.produitId)">
                      Gérer
                    </button>
                  }
                </td>
              </tr>
            </tbody>
          </table>
        </cdk-virtual-scroll-viewport>
      </div>

    } @else {
      <div class="loading-container">
        <app-loading></app-loading>
      </div>
    }
  </div>
</div>