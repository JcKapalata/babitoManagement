<div class="form-container">
  <form [formGroup]="profileForm" (ngSubmit)="onSubmit()" class="profile-card">
    <h2 class="form-title">{{ isUpdateMode ? 'MODIFIER LE PROFIL' : 'NOUVEL AGENT' }}</h2>

    <div class="avatar-upload">
      <div class="preview-container" (click)="fileInput.click()">
        @if (imagePreview) {
          <img [src]="imagePreview" alt="Avatar">
        } @else {
          <div class="placeholder-icon">ðŸ“·</div>
        }
        <div class="overlay"><span>Changer</span></div>
      </div>
      <input type="file" #fileInput (change)="onFileSelected($event)" accept="image/*" hidden>
      <p class="upload-text">Cliquez sur la photo pour modifier</p>
    </div>

    <div class="form-grid">
      <div class="form-group">
        <label>PrÃ©nom</label>
        <input type="text" formControlName="firstName" placeholder="PrÃ©nom">
        @if (profileForm.get('firstName')?.touched && profileForm.get('firstName')?.invalid) {
          <span class="error-text">{{ getErrorMessage('firstName') }}</span>
        }
      </div>

      <div class="form-group">
        <label>Nom</label>
        <input type="text" formControlName="lastName" placeholder="Nom">
        @if (profileForm.get('lastName')?.touched && profileForm.get('lastName')?.invalid) {
          <span class="error-text">{{ getErrorMessage('lastName') }}</span>
        }
      </div>

      <div class="form-group full-width">
        <label>Email</label>
        <input type="email" formControlName="email" placeholder="exemple@mail.com">
        @if (profileForm.get('email')?.touched && profileForm.get('email')?.invalid) {
          <span class="error-text">{{ getErrorMessage('email') }}</span>
        }
      </div>

      <div class="form-group full-width">
        <label>RÃ´le</label>
        <select formControlName="role">
          <option value="" disabled selected>Choisir un rÃ´le</option>
          @for (r of roles; track r) {
            <option [value]="r">{{ r | titlecase }}</option>
          }
        </select>
      </div>

      <div class="form-group">
        <label>Mot de passe</label>
        <input type="password" formControlName="password" placeholder="********">
      </div>

      <div class="form-group">
        <label>Confirmer le mot de passe</label>
        <input type="password" formControlName="confirmPassword" placeholder="********">
        @if (profileForm.get('confirmPassword')?.touched && profileForm.get('confirmPassword')?.invalid) {
          <span class="error-text">{{ getErrorMessage('confirmPassword') }}</span>
        }
      </div>
    </div>

    <div class="form-actions">
      <button type="button" class="btn btn-cancel" (click)="cancel()">ANNULER</button>
      <button type="submit" class="btn btn-submit" [disabled]="profileForm.invalid">
        {{ isUpdateMode ? 'METTRE Ã€ JOUR' : 'ENREGISTRER' }}
      </button>
    </div>
  </form>
</div>